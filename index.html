<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Queue Implementation Visualizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .animate-pulse-scale {
            animation: pulse 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen p-4">
    <div id="app" class="w-full max-w-6xl mx-auto p-6 bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg">
        <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">Queue Implementation Visualizer</h1>
        
        <div class="mb-6 flex gap-4 justify-center flex-wrap">
            <button onclick="switchType('array')" id="arrayBtn" class="px-6 py-3 rounded-lg font-semibold transition-all bg-blue-600 text-white shadow-lg">
                Array Implementation
            </button>
            <button onclick="switchType('linked')" id="linkedBtn" class="px-6 py-3 rounded-lg font-semibold transition-all bg-white text-gray-700 hover:bg-gray-100">
                Linked List Implementation
            </button>
            <button onclick="toggleCode()" class="flex items-center gap-2 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all">
                <span id="codeIcon">üìù</span>
                <span id="codeText">Show</span> Java Code
            </button>
        </div>

        <div class="bg-white rounded-lg p-6 shadow-lg mb-6">
            <h2 id="queueTitle" class="text-xl font-semibold mb-4 text-gray-700">Array-Based Queue</h2>
            <div class="flex justify-center items-center min-h-32 overflow-x-auto pb-4">
                <div id="visualization" class="flex gap-2"></div>
            </div>
        </div>

        <div class="bg-white rounded-lg p-6 shadow-lg mb-6">
            <div class="flex flex-wrap gap-3 items-center justify-center">
                <input type="text" id="inputValue" placeholder="Enter value" 
                    class="px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none">
                <button onclick="enqueue()" class="flex items-center gap-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all">
                    ‚ûï Enqueue
                </button>
                <button onclick="dequeue()" class="flex items-center gap-2 px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all">
                    ‚ûñ Dequeue
                </button>
                <button onclick="peek()" class="flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all">
                    üëÅÔ∏è Peek
                </button>
                <button onclick="isEmpty()" class="flex items-center gap-2 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all">
                    ‚ùì isEmpty
                </button>
                <button onclick="reset()" class="flex items-center gap-2 px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-all">
                    üîÑ Reset
                </button>
            </div>
        </div>

        <div id="message" class="text-center p-4 rounded-lg mb-6 hidden"></div>

        <div id="codeSection" class="bg-white rounded-lg p-6 shadow-lg mb-6 hidden">
            <h3 class="text-xl font-semibold mb-4 text-gray-800">Java Implementation Code</h3>
            <div class="flex gap-2 mb-4 flex-wrap">
                <button onclick="showCode('array')" id="arrayCodeBtn" class="px-4 py-2 rounded bg-blue-600 text-white">
                    Array Code
                </button>
                <button onclick="showCode('linked')" id="linkedCodeBtn" class="px-4 py-2 rounded bg-gray-200">
                    Linked List Code
                </button>
                <button onclick="showCode('circular')" id="circularCodeBtn" class="px-4 py-2 rounded bg-gray-200">
                    Circular Queue Code
                </button>
            </div>
            <pre class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm"><code id="codeDisplay"></code></pre>
        </div>

        <div class="bg-white rounded-lg p-6 shadow-lg">
            <h3 class="text-xl font-semibold mb-4 text-gray-800">Time Complexity Analysis</h3>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="border-2 border-blue-200 rounded-lg p-4">
                    <h4 class="font-bold text-blue-700 mb-3">Array Implementation</h4>
                    <ul class="space-y-2 text-sm">
                        <li><strong>Enqueue:</strong> O(1) - Add to rear</li>
                        <li><strong>Dequeue:</strong> O(1) - Remove from front</li>
                        <li><strong>Peek:</strong> O(1) - Access front element</li>
                        <li><strong>isEmpty:</strong> O(1) - Check pointers</li>
                        <li class="text-red-600 mt-3"><strong>Problem:</strong> Fixed size, wasted space after dequeues</li>
                    </ul>
                </div>
                <div class="border-2 border-green-200 rounded-lg p-4">
                    <h4 class="font-bold text-green-700 mb-3">Linked List Implementation</h4>
                    <ul class="space-y-2 text-sm">
                        <li><strong>Enqueue:</strong> O(1) - Add to rear</li>
                        <li><strong>Dequeue:</strong> O(1) - Remove from front</li>
                        <li><strong>Peek:</strong> O(1) - Access front node</li>
                        <li><strong>isEmpty:</strong> O(1) - Check if head is null</li>
                        <li class="text-green-600 mt-3"><strong>Advantage:</strong> Dynamic size, no wasted space</li>
                    </ul>
                </div>
            </div>
            <div class="mt-6 p-4 bg-yellow-50 border-2 border-yellow-300 rounded-lg">
                <h4 class="font-bold text-yellow-800 mb-2">Best Implementation?</h4>
                <p class="text-sm text-gray-700">
                    <strong>Linked List is generally better</strong> for queues because it has dynamic size and no wasted space. 
                    Array implementation suffers from the problem shown above - space at the beginning becomes unusable after dequeues. 
                    A <strong>Circular Queue</strong> (array-based) solves this by wrapping around, but Linked List remains the most flexible choice.
                </p>
            </div>
        </div>
    </div>

    <script>
        let queueType = 'array';
        let queue = [];
        let arraySize = 8;
        let front = 0;
        let rear = -1;
        let highlightIndex = -1;
        let showingCode = false;
        let currentCodeView = 'array';

        const codes = {
            array: `// Array-Based Queue Implementation
public class ArrayQueue {
    private int[] queue;
    private int front;
    private int rear;
    private int capacity;
    private int size;
    
    public ArrayQueue(int capacity) {
        this.capacity = capacity;
        queue = new int[capacity];
        front = 0;
        rear = -1;
        size = 0;
    }
    
    // Enqueue: Add element to rear - O(1)
    public void enqueue(int item) {
        if (isFull()) {
            throw new IllegalStateException("Queue is full");
        }
        rear++;
        queue[rear] = item;
        size++;
        System.out.println("Enqueued: " + item);
    }
    
    // Dequeue: Remove element from front - O(1)
    public int dequeue() {
        if (isEmpty()) {
            throw new IllegalStateException("Queue is empty");
        }
        int item = queue[front];
        front++;
        size--;
        System.out.println("Dequeued: " + item);
        return item;
    }
    
    // Peek: View front element - O(1)
    public int peek() {
        if (isEmpty()) {
            throw new IllegalStateException("Queue is empty");
        }
        return queue[front];
    }
    
    // Check if empty - O(1)
    public boolean isEmpty() {
        return size == 0;
    }
    
    // Check if full - O(1)
    public boolean isFull() {
        return rear == capacity - 1;
    }
    
    public int size() {
        return size;
    }
}`,
            linked: `// Linked List Queue Implementation
public class LinkedQueue {
    // Node class for linked list
    private class Node {
        int data;
        Node next;
        
        Node(int data) {
            this.data = data;
            this.next = null;
        }
    }
    
    private Node front;
    private Node rear;
    private int size;
    
    public LinkedQueue() {
        front = null;
        rear = null;
        size = 0;
    }
    
    // Enqueue: Add element to rear - O(1)
    public void enqueue(int item) {
        Node newNode = new Node(item);
        
        if (isEmpty()) {
            front = newNode;
            rear = newNode;
        } else {
            rear.next = newNode;
            rear = newNode;
        }
        size++;
        System.out.println("Enqueued: " + item);
    }
    
    // Dequeue: Remove element from front - O(1)
    public int dequeue() {
        if (isEmpty()) {
            throw new IllegalStateException("Queue is empty");
        }
        
        int item = front.data;
        front = front.next;
        
        if (front == null) {
            rear = null;
        }
        
        size--;
        System.out.println("Dequeued: " + item);
        return item;
    }
    
    // Peek: View front element - O(1)
    public int peek() {
        if (isEmpty()) {
            throw new IllegalStateException("Queue is empty");
        }
        return front.data;
    }
    
    // Check if empty - O(1)
    public boolean isEmpty() {
        return front == null;
    }
    
    public int size() {
        return size;
    }
}`,
            circular: `// Circular Queue
public class CircularQueue {
    private int[] queue;
    private int front;
    private int rear;
    private int capacity;
    private int size;
    
    public CircularQueue(int capacity) {
        this.capacity = capacity;
        queue = new int[capacity];
        front = 0;
        rear = -1;
        size = 0;
    }
    
    // Enqueue with circular wrapping - O(1)
    public void enqueue(int item) {
        if (isFull()) {
            throw new IllegalStateException("Queue is full");
        }
        rear = (rear + 1) % capacity;
        queue[rear] = item;
        size++;
    }
    
    // Dequeue with circular wrapping - O(1)
    public int dequeue() {
        if (isEmpty()) {
            throw new IllegalStateException("Queue is empty");
        }
        int item = queue[front];
        front = (front + 1) % capacity;
        size--;
        return item;
    }
    
    public boolean isEmpty() {
        return size == 0;
    }
    
    public boolean isFull() {
        return size == capacity;
    }
}`
        };

        function showMessage(msg, isError = false) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = msg;
            messageEl.className = `text-center p-4 rounded-lg mb-6 ${
                isError ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'
            }`;
            messageEl.classList.remove('hidden');
            setTimeout(() => messageEl.classList.add('hidden'), 3000);
        }

        function switchType(type) {
            queueType = type;
            reset();
            document.getElementById('arrayBtn').className = type === 'array' 
                ? 'px-6 py-3 rounded-lg font-semibold transition-all bg-blue-600 text-white shadow-lg'
                : 'px-6 py-3 rounded-lg font-semibold transition-all bg-white text-gray-700 hover:bg-gray-100';
            document.getElementById('linkedBtn').className = type === 'linked'
                ? 'px-6 py-3 rounded-lg font-semibold transition-all bg-green-600 text-white shadow-lg'
                : 'px-6 py-3 rounded-lg font-semibold transition-all bg-white text-gray-700 hover:bg-gray-100';
            document.getElementById('queueTitle').textContent = type === 'array' 
                ? 'Array-Based Queue' 
                : 'Linked List Queue';
            render();
        }

        function toggleCode() {
            showingCode = !showingCode;
            document.getElementById('codeSection').classList.toggle('hidden');
            document.getElementById('codeText').textContent = showingCode ? 'Hide' : 'Show';
            if (showingCode) {
                showCode(currentCodeView);
            }
        }

        function showCode(type) {
            currentCodeView = type;
            document.getElementById('codeDisplay').textContent = codes[type];
            ['arrayCodeBtn', 'linkedCodeBtn', 'circularCodeBtn'].forEach(id => {
                document.getElementById(id).className = 'px-4 py-2 rounded bg-gray-200';
            });
            const btnMap = {array: 'arrayCodeBtn', linked: 'linkedCodeBtn', circular: 'circularCodeBtn'};
            document.getElementById(btnMap[type]).className = 'px-4 py-2 rounded ' + 
                (type === 'array' ? 'bg-blue-600' : type === 'linked' ? 'bg-green-600' : 'bg-orange-600') + ' text-white';
        }

        async function enqueue() {
            const input = document.getElementById('inputValue');
            const value = input.value.trim();
            
            if (!value) {
                showMessage('Please enter a value', true);
                return;
            }

            if (queueType === 'array') {
                if (rear >= arraySize - 1) {
                    showMessage('Queue is full!', true);
                    return;
                }
                highlightIndex = rear + 1;
                render();
                await sleep(500);
                
                queue[rear + 1] = value;
                rear++;
                
                await sleep(500);
                highlightIndex = -1;
                render();
                showMessage(`Enqueued: ${value}`);
            } else {
                highlightIndex = queue.length;
                render();
                await sleep(500);
                
                queue.push(value);
                
                await sleep(500);
                highlightIndex = -1;
                render();
                showMessage(`Enqueued: ${value}`);
            }
            input.value = '';
        }

        async function dequeue() {
            if (queueType === 'array') {
                if (front > rear || rear < 0) {
                    showMessage('Queue is empty!', true);
                    return;
                }
                highlightIndex = front;
                render();
                await sleep(500);
                
                const value = queue[front];
                queue[front] = undefined;
                front++;
                
                await sleep(500);
                highlightIndex = -1;
                render();
                showMessage(`Dequeued: ${value}`);
            } else {
                if (queue.length === 0) {
                    showMessage('Queue is empty!', true);
                    return;
                }
                highlightIndex = 0;
                render();
                await sleep(500);
                
                const value = queue.shift();
                
                await sleep(500);
                highlightIndex = -1;
                render();
                showMessage(`Dequeued: ${value}`);
            }
        }

        async function peek() {
            if (queueType === 'array') {
                if (front > rear || rear < 0) {
                    showMessage('Queue is empty!', true);
                    return;
                }
                highlightIndex = front;
                render();
                showMessage(`Front element: ${queue[front]}`);
                await sleep(1000);
                highlightIndex = -1;
                render();
            } else {
                if (queue.length === 0) {
                    showMessage('Queue is empty!', true);
                    return;
                }
                highlightIndex = 0;
                render();
                showMessage(`Front element: ${queue[0]}`);
                await sleep(1000);
                highlightIndex = -1;
                render();
            }
        }

        function isEmpty() {
            if (queueType === 'array') {
                const empty = front > rear || rear < 0;
                showMessage(empty ? 'Queue is empty: true' : 'Queue is empty: false');
            } else {
                showMessage(queue.length === 0 ? 'Queue is empty: true' : 'Queue is empty: false');
            }
        }

        function reset() {
            queue = [];
            front = 0;
            rear = -1;
            highlightIndex = -1;
            document.getElementById('inputValue').value = '';
            render();
        }

        function render() {
            const viz = document.getElementById('visualization');
            
            if (queueType === 'array') {
                let html = '';
                for (let i = 0; i < arraySize; i++) {
                    const isFront = i === front && front <= rear && rear >= 0;
                    const isRear = i === rear && rear >= 0;
                    const isHighlight = i === highlightIndex;
                    
                    html += `
                        <div class="flex flex-col items-center">
                            <div class="w-16 h-16 border-2 flex items-center justify-center text-lg font-semibold transition-all duration-300 ${
                                isHighlight ? 'bg-yellow-300 border-yellow-500 scale-110 animate-pulse-scale' :
                                queue[i] !== undefined ? 'bg-blue-100 border-blue-500' : 'bg-gray-100 border-gray-300'
                            }">
                                ${queue[i] !== undefined ? queue[i] : ''}
                            </div>
                            <div class="text-xs mt-1 text-gray-600">${i}</div>
                            ${(isFront || isRear) ? `
                                <div class="text-xs mt-1 font-bold ${isFront ? 'text-green-600' : 'text-red-600'}">
                                    ${isFront ? 'FRONT' : ''}${isRear && isFront ? ' / ' : ''}${isRear ? 'REAR' : ''}
                                </div>
                            ` : ''}
                        </div>
                    `;
                }
                viz.innerHTML = html;
            } else {
                if (queue.length === 0) {
                    viz.innerHTML = '<div class="text-gray-400 text-lg">Empty Queue</div>';
                } else {
                    let html = '';
                    queue.forEach((item, index) => {
                        const isHighlight = index === highlightIndex;
                        html += `
                            <div class="flex items-center">
                                <div class="flex flex-col items-center transition-all duration-300 ${isHighlight ? 'scale-110 animate-pulse-scale' : ''}">
                                    <div class="w-20 h-16 border-2 flex items-center justify-center text-lg font-semibold ${
                                        isHighlight ? 'bg-yellow-300 border-yellow-500' : 'bg-green-100 border-green-500'
                                    }">
                                        ${item}
                                    </div>
                                    ${index === 0 ? '<div class="text-xs mt-1 font-bold text-green-600">FRONT</div>' : ''}
                                    ${index === queue.length - 1 ? '<div class="text-xs mt-1 font-bold text-red-600">REAR</div>' : ''}
                                </div>
                                ${index < queue.length - 1 ? '<div class="mx-2 text-2xl text-gray-400">‚Üí</div>' : ''}
                            </div>
                        `;
                    });
                    viz.innerHTML = html;
                }
            }
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        render();
    </script>
</body>
</html>
